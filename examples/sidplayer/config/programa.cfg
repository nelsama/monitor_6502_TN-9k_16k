# programa.cfg - Configuración del linker para SID Player (programa C)
# Carga en $2800 - compromiso entre espacio para SIDs y tamaño del player
# SIDs en $0800-$27FF (~8KB), Player en $2800-$3DFF (~5.5KB)

SYMBOLS {
    __STACKSIZE__: type = weak, value = $0100;         # 256 bytes de stack
    __STACKSTART__: type = weak, value = $3FFF;        # Stack en $3F00-$3FFF
    
    # Símbolos requeridos por el runtime C
    __CONSTRUCTOR_COUNT__: type = weak, value = 0;
    __DESTRUCTOR_COUNT__: type = weak, value = 0;
    __CONSTRUCTOR_TABLE__: type = weak, value = $2600;
    __DESTRUCTOR_TABLE__: type = weak, value = $2600;
}

MEMORY {
    # Zero Page: usar $20-$7F para no conflictuar con el monitor ($02-$1F)
    ZP:  start = $0020, size = $0060, type = rw, define = yes;
    
    # RAM para el programa: $2600-$3EFF (~6.25KB para el player)
    # SIDs se cargan en $0800-$25FF (~7.5KB para SIDs)
    RAM: start = $2600, size = $1900, type = rw, file = %O, define = yes;
    
    # Stack area: $3F00-$3FFF (256 bytes)
    STACK: start = $3F00, size = $0100, type = rw, define = yes;
}

SEGMENTS {
    # Zero Page para variables
    ZEROPAGE: load = ZP, type = zp, define = yes;
    
    # Código principal (inicia en $2000)
    STARTUP:  load = RAM, type = ro;
    
    # Código adicional
    CODE:     load = RAM, type = ro, optional = yes;
    
    # Código de inicialización (ejecutado una vez)
    ONCE:     load = RAM, type = ro, optional = yes;
    
    # Datos de solo lectura (tablas, strings)
    RODATA:   load = RAM, type = ro, optional = yes;
    
    # Datos inicializados
    DATA:     load = RAM, type = rw, define = yes, optional = yes;
    
    # Datos sin inicializar
    BSS:      load = RAM, type = bss, define = yes, optional = yes;
}
