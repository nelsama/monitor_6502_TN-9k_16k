# programa.cfg - Configuración del linker para SID Player (programa C)
# Carga en $1800 para dejar espacio para SIDs pequeños ($1000-$17FF)

SYMBOLS {
    __STACKSIZE__: type = weak, value = $0100;         # 256 bytes de stack
    __STACKSTART__: type = weak, value = $3DFF;        # Stack en $3D00-$3DFF
    
    # Símbolos requeridos por el runtime C
    __CONSTRUCTOR_COUNT__: type = weak, value = 0;
    __DESTRUCTOR_COUNT__: type = weak, value = 0;
    __CONSTRUCTOR_TABLE__: type = weak, value = $1800;
    __DESTRUCTOR_TABLE__: type = weak, value = $1800;
}

MEMORY {
    # Zero Page: usar $20-$7F para no conflictuar con el monitor ($02-$1F)
    ZP:  start = $0020, size = $0060, type = rw, define = yes;
    
    # RAM para el programa: $1800-$3CFF 
    # SIDs pequeños en $1000-$17FF (~2KB para SIDs)
    RAM: start = $1800, size = $2500, type = rw, file = %O, define = yes;
    
    # Stack area
    STACK: start = $3D00, size = $0100, type = rw, define = yes;
}

SEGMENTS {
    # Zero Page para variables
    ZEROPAGE: load = ZP, type = zp, define = yes;
    
    # Código principal (inicia en $2000)
    STARTUP:  load = RAM, type = ro;
    
    # Código adicional
    CODE:     load = RAM, type = ro, optional = yes;
    
    # Código de inicialización (ejecutado una vez)
    ONCE:     load = RAM, type = ro, optional = yes;
    
    # Datos de solo lectura (tablas, strings)
    RODATA:   load = RAM, type = ro, optional = yes;
    
    # Datos inicializados
    DATA:     load = RAM, type = rw, define = yes, optional = yes;
    
    # Datos sin inicializar
    BSS:      load = RAM, type = bss, define = yes, optional = yes;
}
