# programa.cfg - Configuración del linker para programas en C
# Carga en $0800 para ejecutar desde el Monitor 6502
# Plantilla optimizada para programas pequeños usando ROM API

SYMBOLS {
    __STACKSIZE__: type = weak, value = $0100;         # 256 bytes de stack
    __STACKSTART__: type = weak, value = $3DFF;        # Stack en $3E00-$3DFF
    
    # Símbolos requeridos por el runtime C
    __CONSTRUCTOR_COUNT__: type = weak, value = 0;
    __DESTRUCTOR_COUNT__: type = weak, value = 0;
    __CONSTRUCTOR_TABLE__: type = weak, value = $0800;
    __DESTRUCTOR_TABLE__: type = weak, value = $0800;
}

MEMORY {
    # Zero Page: usar $20-$7F para no conflictuar con el monitor ($02-$1F)
    ZP:  start = $0020, size = $0060, type = rw, define = yes;
    
    # RAM para el programa: $0800-$3DFF (~13.5KB)
    RAM: start = $0800, size = $3600, type = rw, file = %O, define = yes;
    
    # Stack area: $3E00-$3FFF (512 bytes)
    STACK: start = $3E00, size = $0200, type = rw, define = yes;
}

SEGMENTS {
    # Zero Page para variables
    ZEROPAGE: load = ZP, type = zp, define = yes;
    
    # Código principal (inicia en $0800)
    STARTUP:  load = RAM, type = ro;
    
    # Código adicional
    CODE:     load = RAM, type = ro, optional = yes;
    
    # Código de inicialización (ejecutado una vez)
    ONCE:     load = RAM, type = ro, optional = yes;
    
    # Datos de solo lectura (tablas, strings)
    RODATA:   load = RAM, type = ro, optional = yes;
    
    # Datos inicializados
    DATA:     load = RAM, type = rw, define = yes, optional = yes;
    
    # Datos sin inicializar
    BSS:      load = RAM, type = bss, define = yes, optional = yes;
}
